<?xml version="1.0" encoding="utf-8"?>
<Window
    x:Class="TextEase.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:local="using:TextEase"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    mc:Ignorable="d">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Menu Bar -->
        <MenuBar Grid.Row="0">
            <MenuBarItem Title="File">
                <MenuFlyoutItem Text="New" Click="NewFile_Click"/>
                <MenuFlyoutItem Text="Open" Click="OpenFile_Click"/>
                <MenuFlyoutItem Text="Save" Click="SaveFile_Click"/>
                <MenuFlyoutItem Text="Save As" Click="SaveAsFile_Click"/>
                <MenuFlyoutSeparator/>
                <MenuFlyoutItem Text="Exit" Click="Exit_Click"/>
            </MenuBarItem>
            <MenuBarItem Title="Edit">
                <MenuFlyoutItem Text="Find/Replace" Click="ShowFindReplace_Click"/>
            </MenuBarItem>
        </MenuBar>

        <!-- Tool Bar -->
        <CommandBar Grid.Row="1" DefaultLabelPosition="Right">
            <AppBarButton Icon="Save" Label="Save" Click="SaveFile_Click"/>
            <AppBarButton Icon="OpenFile" Label="Open" Click="OpenFile_Click"/>
            <AppBarSeparator/>
            <AppBarButton Icon="Find" Label="Find" Click="ShowFindReplace_Click"/>
        </CommandBar>

        <!-- Main Content -->
        <Grid Grid.Row="2">
            <!-- Find/Replace Panel -->
            <TeachingTip x:Name="FindReplacePanel"
                        Title="Find and Replace"
                        PreferredPlacement="Top"
                        IsLightDismissEnabled="False"
                        PlacementMargin="20"
                        ShouldConstrainToRootBounds="True"
                        Target="{x:Bind MainEditor}"
                        ActionButtonContent="Close"
                        ActionButtonClick="CloseFindReplace_Click"
                        IsOpen="False"
                        Background="{ThemeResource LayerFillColorDefaultBrush}"
                        BorderBrush="{ThemeResource CardStrokeColorDefaultBrush}"
                        MinWidth="450">
                <Grid Padding="16">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="12"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="16"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Find Section -->
                    <Grid Grid.Row="0">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Text="Find:" Grid.Column="0" 
                                 VerticalAlignment="Center" 
                                 Margin="0,0,12,0"
                                 Style="{ThemeResource BodyTextBlockStyle}"/>
                        
                        <TextBox x:Name="FindBox" Grid.Column="1" 
                                PlaceholderText="Enter text to find..."
                                TextChanged="FindBox_TextChanged">
                            <TextBox.KeyboardAccelerators>
                                <KeyboardAccelerator Key="Enter" 
                                                   Modifiers="None"
                                                   Invoked="FindNext_Invoked"/>
                            </TextBox.KeyboardAccelerators>
                        </TextBox>
                        
                        <Button Grid.Column="2"
                                Margin="8,0,0,0"
                                Style="{ThemeResource AccentButtonStyle}"
                                Click="FindNext_Click">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <FontIcon FontFamily="Segoe MDL2 Assets" Glyph="&#xE0AB;"/>
                                <TextBlock Text="Find Next"/>
                            </StackPanel>
                        </Button>
                    </Grid>

                    <!-- Replace Section -->
                    <Grid Grid.Row="2">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Text="Replace:" Grid.Column="0" 
                                 VerticalAlignment="Center" 
                                 Margin="0,0,12,0"
                                 Style="{ThemeResource BodyTextBlockStyle}"/>
                        
                        <TextBox x:Name="ReplaceBox" Grid.Column="1" 
                                PlaceholderText="Enter replacement text..."/>
                        
                        <Button Grid.Column="2"
                                Margin="8,0,0,0"
                                Click="Replace_Click">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <FontIcon FontFamily="Segoe MDL2 Assets" Glyph="&#xE8AC;"/>
                                <TextBlock Text="Replace"/>
                            </StackPanel>
                        </Button>
                    </Grid>

                    <!-- Action Buttons -->
                    <StackPanel Grid.Row="4" 
                              Orientation="Horizontal" 
                              HorizontalAlignment="Right"
                              Spacing="8">
                        <Button Click="ReplaceAll_Click">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <FontIcon FontFamily="Segoe MDL2 Assets" Glyph="&#xE8A1;"/>
                                <TextBlock Text="Replace All"/>
                            </StackPanel>
                        </Button>
                    </StackPanel>
                </Grid>
            </TeachingTip>

            <!-- Editor Area -->
            <ScrollViewer Margin="0,1,0,0"
                         HorizontalScrollBarVisibility="Auto" 
                         VerticalScrollBarVisibility="Auto">
                <TextBox x:Name="MainEditor"
                        AcceptsReturn="True"
                        TextWrapping="Wrap"
                        TextChanged="MainEditor_TextChanged"
                        HorizontalAlignment="Stretch"
                        VerticalAlignment="Stretch"
                        MinHeight="400"/>
            </ScrollViewer>
        </Grid>

        <!-- Status Bar -->
        <Grid Grid.Row="3" 
              Background="{ThemeResource LayerFillColorDefaultBrush}"
              Height="32">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <TextBlock x:Name="StatusText"
                      Text="Ready"
                      VerticalAlignment="Center"
                      Margin="12,0"/>
        </Grid>
    </Grid>
</Window>
